<html>
<head>
    <title>Details</title>
    <meta charset="UTF-8">
    <meta name="description" content="Pagina details">
    <meta name="author" content="Alvaro Aviles Redondo - bp0259">
    <meta name="author" content="Jesus Anton Diaz - bp0005">
    <!--- estilos con CSS -->
    <link rel="stylesheet" href="../styles.css">
</head>
<body onload="cargaDetails()">
<div class="contenedor-details">
    <div class="cabecera-principal" id="cabecera_details">
    </div>
    <div id="div-botonVolver-details">
    </div><div class= "div_info" id="div_info_usuario">
    </div>
    <div class="contenido">
        <div class="div_izquierda_details" id="div_informacion">
        </div>
        <div class="div_derecha_details" id="div_wiki">
        </div>
    </div>
</div>
<script>

    function cargaDetails(){
        //Recuperamos los datos del querystring del URL
        const urlParams = new URLSearchParams(window.location.search);
        const name = urlParams.get('name');
        const birthDate = urlParams.get('birthDate');
        const deathDate = urlParams.get('deathDate');
        const imageUrl = urlParams.get('imageUrl');
        const wikiUrl = urlParams.get('wikiUrl');
        const persons = urlParams.get('persons');
        const entities = urlParams.get('entities');
        let authHeader = urlParams.get('authHeader');
        let  userName = urlParams.get('userName');
        let  userRole = urlParams.get('userRole');

        let h1 = document.createElement("h1");
        let text_h1 = document.createTextNode("Anales de la Ciencia - "+name);
        h1.appendChild(text_h1);
        document.getElementById("cabecera_details").appendChild(h1);

        let volverButton = document.createElement("button");
        volverButton.name = "Volver";
        volverButton.textContent = "Volver";
        volverButton.setAttribute("onclick", "Volver()");
        document.getElementById("div-botonVolver-details").appendChild(volverButton);

        let h2 = document.createElement("h2");
        let text_h2 = document.createTextNode(name);
        h2.appendChild(text_h2);
        document.getElementById("div_informacion").appendChild(h2);

        let h4_1 = document.createElement("h4");
        let text_h4_1 = document.createTextNode("Birth Date = " +birthDate);
        h4_1.appendChild(text_h4_1);
        document.getElementById("div_informacion").appendChild(h4_1);

        let h4_2 = document.createElement("h4");
        let text_h4_2 = document.createTextNode("Death Date = " +deathDate);
        h4_2.appendChild(text_h4_2);
        document.getElementById("div_informacion").appendChild(h4_2);

        let image = document.createElement("img");
        image.src = imageUrl;
        image.style.width = "450";
        image.style.height = "450";
        image.alt = name;
        document.getElementById("div_informacion").appendChild(image);

        let iframe = document.createElement("iframe");
        iframe.src = wikiUrl;
        iframe.title = "Wiki " +name;
        iframe.width = "600";
        iframe.height = "600";
        document.getElementById("div_wiki").appendChild(iframe);

        let p = document.createElement("p");
        let text = document.createTextNode("User: " +userName+ " - Role: " +userRole);
        p.appendChild(text);
        document.getElementById("div_info_usuario").appendChild(p);
    }

    function Volver(){
        const urlParams = new URLSearchParams(window.location.search);
        let authHeader = urlParams.get('authHeader');
        let  userName = urlParams.get('userName');
        let  userRole = urlParams.get('userRole');

        if (userRole === "reader"){
            location.replace("http://127.0.0.1:8000/webPage/readerSubsystem/reader.html?authHeader=" +authHeader+ "&userName=" +userName+ "&userRole=" +userRole);
        }else{
            location.replace("http://127.0.0.1:8000/webPage/writerSubsystem/writer.html?authHeader=" +authHeader+ "&userName=" +userName+ "&userRole=" +userRole);
        }

    }
</script>
</body>
</html>